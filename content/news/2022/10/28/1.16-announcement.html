<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Apache Flink: Announcing the Release of Apache Flink 1.16</title>
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">

    <!-- Bootstrap -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/flink.css">
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Blog RSS feed -->
    <link href="/blog/feed.xml" rel="alternate" type="application/rss+xml" title="Apache Flink Blog: RSS feed" />

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <!-- We need to load Jquery in the header for custom google analytics event tracking-->
    <script src="/js/jquery.min.js"></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- Matomo -->
    <script>
      var _paq = window._paq = window._paq || [];
      /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
      /* We explicitly disable cookie tracking to avoid privacy issues */
      _paq.push(['disableCookies']);
      /* Measure a visit to flink.apache.org and nightlies.apache.org/flink as the same visit */
      _paq.push(["setDomains", ["*.flink.apache.org","*.nightlies.apache.org/flink"]]);
      _paq.push(['trackPageView']);
      _paq.push(['enableLinkTracking']);
      (function() {
        var u="//matomo.privacy.apache.org/";
        _paq.push(['setTrackerUrl', u+'matomo.php']);
        _paq.push(['setSiteId', '1']);
        var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
        g.async=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
      })();
    </script>
    <!-- End Matomo Code -->
  </head>
  <body>  
    

    <!-- Main content. -->
    <div class="container">
    <div class="row">

      
     <div id="sidebar" class="col-sm-3">
        

<!-- Top navbar. -->
    <nav class="navbar navbar-default">
        <!-- The logo. -->
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <div class="navbar-logo">
            <a href="/">
              <img alt="Apache Flink" src="/img/flink-header-logo.svg" width="147px" height="73px">
            </a>
          </div>
        </div><!-- /.navbar-header -->

        <!-- The navigation links. -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
          <ul class="nav navbar-nav navbar-main">

            <!-- First menu section explains visitors what Flink is -->

            <!-- What is Stream Processing? -->
            <!--
            <li><a href="/streamprocessing1.html">What is Stream Processing?</a></li>
            -->

            <!-- What is Flink? -->
            <li><a href="/flink-architecture.html">What is Apache Flink?</a></li>

            

            <!-- Stateful Functions? -->

            <li><a href="https://nightlies.apache.org/flink/flink-statefun-docs-stable/">What is Stateful Functions?</a></li>

            <!-- Flink ML? -->

            <li><a href="https://nightlies.apache.org/flink/flink-ml-docs-stable/">What is Flink ML?</a></li>

            <!-- Flink Kubernetes Operator? -->

            <li><a href="https://nightlies.apache.org/flink/flink-kubernetes-operator-docs-stable/">What is the Flink Kubernetes Operator?</a></li>

            <!-- Flink Table Store? -->

            <li><a href="https://nightlies.apache.org/flink/flink-table-store-docs-stable/">What is Flink Table Store?</a></li>

            <!-- Use cases -->
            <li><a href="/usecases.html">Use Cases</a></li>

            <!-- Powered by -->
            <li><a href="/poweredby.html">Powered By</a></li>


            &nbsp;
            <!-- Second menu section aims to support Flink users -->

            <!-- Downloads -->
            <li><a href="/downloads.html">Downloads</a></li>

            <!-- Getting Started -->
            <li class="dropdown">
              <a class="dropdown-toggle" data-toggle="dropdown" href="#">Getting Started<span class="caret"></span></a>
              <ul class="dropdown-menu">
                <li><a href="https://nightlies.apache.org/flink/flink-docs-release-1.15//docs/try-flink/local_installation/" target="_blank">With Flink <small><span class="glyphicon glyphicon-new-window"></span></small></a></li>
                <li><a href="https://nightlies.apache.org/flink/flink-statefun-docs-release-3.2/getting-started/project-setup.html" target="_blank">With Flink Stateful Functions <small><span class="glyphicon glyphicon-new-window"></span></small></a></li>
                <li><a href="https://nightlies.apache.org/flink/flink-ml-docs-release-2.1/try-flink-ml/quick-start.html" target="_blank">With Flink ML <small><span class="glyphicon glyphicon-new-window"></span></small></a></li>
                <li><a href="https://nightlies.apache.org/flink/flink-kubernetes-operator-docs-release-1.2/try-flink-kubernetes-operator/quick-start.html" target="_blank">With Flink Kubernetes Operator <small><span class="glyphicon glyphicon-new-window"></span></small></a></li>
                <li><a href="https://nightlies.apache.org/flink/flink-table-store-docs-release-0.2/try-table-store/quick-start.html" target="_blank">With Flink Table Store <small><span class="glyphicon glyphicon-new-window"></span></small></a></li>
                <li><a href="/training.html">Training Course</a></li>
              </ul>
            </li>

            <!-- Documentation -->
            <li class="dropdown">
              <a class="dropdown-toggle" data-toggle="dropdown" href="#">Documentation<span class="caret"></span></a>
              <ul class="dropdown-menu">
                <li><a href="https://nightlies.apache.org/flink/flink-docs-release-1.15" target="_blank">Flink 1.16 (Latest stable release) <small><span class="glyphicon glyphicon-new-window"></span></small></a></li>
                <li><a href="https://nightlies.apache.org/flink/flink-docs-master" target="_blank">Flink Master (Latest Snapshot) <small><span class="glyphicon glyphicon-new-window"></span></small></a></li>
                <li><a href="https://nightlies.apache.org/flink/flink-statefun-docs-release-3.2" target="_blank">Flink Stateful Functions 3.2 (Latest stable release) <small><span class="glyphicon glyphicon-new-window"></span></small></a></li>
                <li><a href="https://nightlies.apache.org/flink/flink-statefun-docs-master" target="_blank">Flink Stateful Functions Master (Latest Snapshot) <small><span class="glyphicon glyphicon-new-window"></span></small></a></li>
                <li><a href="https://nightlies.apache.org/flink/flink-ml-docs-release-2.1" target="_blank">Flink ML 2.1 (Latest stable release) <small><span class="glyphicon glyphicon-new-window"></span></small></a></li>
                <li><a href="https://nightlies.apache.org/flink/flink-ml-docs-master" target="_blank">Flink ML Master (Latest Snapshot) <small><span class="glyphicon glyphicon-new-window"></span></small></a></li>
                <li><a href="https://nightlies.apache.org/flink/flink-kubernetes-operator-docs-release-1.2" target="_blank">Flink Kubernetes Operator 1.2 (Latest stable release) <small><span class="glyphicon glyphicon-new-window"></span></small></a></li>
                <li><a href="https://nightlies.apache.org/flink/flink-kubernetes-operator-docs-main" target="_blank">Flink Kubernetes Operator Main (Latest Snapshot) <small><span class="glyphicon glyphicon-new-window"></span></small></a></li>
                <li><a href="https://nightlies.apache.org/flink/flink-table-store-docs-release-0.2" target="_blank">Flink Table Store 0.2 (Latest stable release) <small><span class="glyphicon glyphicon-new-window"></span></small></a></li>
                <li><a href="https://nightlies.apache.org/flink/flink-table-store-docs-master" target="_blank">Flink Table Store Master (Latest Snapshot) <small><span class="glyphicon glyphicon-new-window"></span></small></a></li>
              </ul>
            </li>

            <!-- getting help -->
            <li><a href="/gettinghelp.html">Getting Help</a></li>

            <!-- Blog -->
            <li class="active"><a href="/blog/"><b>Flink Blog</b></a></li>


            <!-- Flink-packages -->
            <li>
              <a href="https://flink-packages.org" target="_blank">flink-packages.org <small><span class="glyphicon glyphicon-new-window"></span></small></a>
            </li>
            &nbsp;

            <!-- Third menu section aim to support community and contributors -->

            <!-- Community -->
            <li><a href="/community.html">Community &amp; Project Info</a></li>

            <!-- Roadmap -->
            <li><a href="/roadmap.html">Roadmap</a></li>

            <!-- Contribute -->
            <li><a href="/contributing/how-to-contribute.html">How to Contribute</a></li>
            

            <!-- GitHub -->
            <li>
              <a href="https://github.com/apache/flink" target="_blank">Flink on GitHub <small><span class="glyphicon glyphicon-new-window"></span></small></a>
            </li>

            &nbsp;

            <!-- Language Switcher -->
            <li>
              
                
                  <!-- link to the Chinese home page when current is blog page -->
                  <a href="/zh">中文版</a>
                
              
            </li>

          </ul>

          <style>
            .smalllinks:link {
              display: inline-block !important; background: none; padding-top: 0px; padding-bottom: 0px; padding-right: 0px; min-width: 75px;
            }
          </style>

          <ul class="nav navbar-nav navbar-bottom">
          <hr />

            <!-- Twitter -->
            <li><a href="https://twitter.com/apacheflink" target="_blank">@ApacheFlink <small><span class="glyphicon glyphicon-new-window"></span></small></a></li>

            <!-- Visualizer -->
            <li class=" hidden-md hidden-sm"><a href="/visualizer/" target="_blank">Plan Visualizer <small><span class="glyphicon glyphicon-new-window"></span></small></a></li>

            <li >
                  <a href="/security.html">Flink Security</a>
            </li>

          <hr />

            <li><a href="https://apache.org" target="_blank">Apache Software Foundation <small><span class="glyphicon glyphicon-new-window"></span></small></a></li>

            <li>

              <a class="smalllinks" href="https://www.apache.org/licenses/" target="_blank">License</a> <small><span class="glyphicon glyphicon-new-window"></span></small>

              <a class="smalllinks" href="https://www.apache.org/security/" target="_blank">Security</a> <small><span class="glyphicon glyphicon-new-window"></span></small>

              <a class="smalllinks" href="https://www.apache.org/foundation/sponsorship.html" target="_blank">Donate</a> <small><span class="glyphicon glyphicon-new-window"></span></small>

              <a class="smalllinks" href="https://www.apache.org/foundation/thanks.html" target="_blank">Thanks</a> <small><span class="glyphicon glyphicon-new-window"></span></small>
            </li>

          </ul>
        </div><!-- /.navbar-collapse -->
    </nav>

      </div>
      <div class="col-sm-9">
      <div class="row-fluid">
  <div class="col-sm-12">
    <div class="row">
      <h1>Announcing the Release of Apache Flink 1.16</h1>
      <p><i></i></p>

      <article>
        <p>28 Oct 2022 Godfrey He (<a href="https://twitter.com/godfreyhe">@godfreyhe</a>)</p>

<p>Apache Flink continues to grow at a rapid pace and is one of the most active 
communities in Apache. Flink 1.16 had over 230 contributors enthusiastically participating, 
with 19 FLIPs and 900+ issues completed, bringing a lot of exciting features to the community.</p>

<p>Flink has become the leading role and factual standard of stream processing, 
and the concept of the unification of stream and batch data processing is gradually gaining recognition 
and is being successfully implemented in more and more companies. Previously, 
the integrated stream and batch concept placed more emphasis on a unified API and 
a unified computing framework. This year, based on this, Flink proposed 
the next development direction of <a href="https://www.alibabacloud.com/blog/more-than-computing-a-new-era-led-by-the-warehouse-architecture-of-apache-flink_598821">Flink-Streaming Warehouse</a> (Streamhouse), 
which further upgraded the scope of stream-batch integration: it truly completes not only 
the unified computation but also unified storage, thus realizing unified real-time analysis.</p>

<p>In 1.16, the Flink community has completed many improvements for both batch and stream processing:</p>

<ul>
  <li>For batch processing, all-round improvements in ease of use, stability and performance 
 have been completed. 1.16 is a milestone version of Flink batch processing and an important 
 step towards maturity.
    <ul>
      <li>Ease of use:  with the introduction of SQL Gateway and full compatibility with Hive Server2, 
users can submit Flink SQL jobs and Hive SQL jobs very easily, and it is also easy to 
connect to the original Hive ecosystem.</li>
      <li>Functionality: Join hints let Flink SQL users manually specify join strategies
to avoid unreasonable execution plans. The compatibility of Hive SQL has reached 94%,
and users can migrate from Hive to Flink at a very low cost.</li>
      <li>Stability: Propose a speculative execution mechanism to reduce the long tail sub-tasks of
a job and improve the stability. Improve HashJoin and introduce failure rollback mechanism
to avoid join failure.</li>
      <li>Performance: Introduce dynamic partition pruning to reduce the Scan I/O and improve join 
processing for the star-schema queries. There is 30% improvement in the TPC-DS benchmark. 
We can use hybrid shuffle mode to improve resource usage and processing performance.</li>
    </ul>
  </li>
  <li>For stream processing, there are a number of significant improvements:
    <ul>
      <li>Changelog State Backend provides users with second or even millisecond checkpoints to 
dramatically improve the fault tolerance experience, while providing a smaller end-to-end 
latency experience for transactional Sink jobs.</li>
      <li>Lookup join is widely used in stream processing. Slow lookup speed, low throughput and 
delay update are resolved through common cache mechanism, asynchronous io and retriable lookup. 
These features are very useful, solving the pain points that users often complain about, 
and supporting richer scenarios.</li>
      <li>From the first day of the birth of Flink SQL, there were some non-deterministic operations 
that could cause incorrect results or exceptions, which caused great distress to users. 
In 1.16, we spent a lot of effort to solve most of the problems, and we will continue to 
improve in the future.</li>
    </ul>
  </li>
</ul>

<p>With the further refinement of the integration of stream and batch, and the continuous iteration of 
the Flink Table Store (<a href="https://flink.apache.org/news/2022/08/29/release-table-store-0.2.0.html">0.2 has been released</a>), 
the Flink community is pushing the Streaming warehouse from concept to reality and maturity step by step.</p>

<h1 id="understanding-streaming-warehouses">Understanding Streaming Warehouses</h1>

<p>To be precise, a streaming warehouse is to make data warehouse streaming, which allows the data 
for each layer in the whole warehouse to flow in real-time. The goal is to realize 
a Streaming Service with end-to-end real-time performance through a unified API and computing framework.
Please refer to <a href="https://www.alibabacloud.com/blog/more-than-computing-a-new-era-led-by-the-warehouse-architecture-of-apache-flink_598821">the article</a> 
for more details.</p>

<h1 id="batch-processing">Batch processing</h1>

<p>Flink is a unified stream batch processing engine, stream processing has become the leading role 
thanks to our long-term investment. We’re also putting more effort to improve batch processing 
to make it an excellent computing engine. This makes the overall experience of stream batch 
unification smoother.</p>

<h2 id="sql-gateway">SQL Gateway</h2>

<p>The feedback from various channels indicates that <a href="https://nightlies.apache.org/flink/flink-docs-release-1.16/docs/dev/table/sql-gateway/overview/">SQL Gateway</a> 
is a highly anticipated feature for users, especially for batch users. This function finally 
completed (see <a href="https://cwiki.apache.org/confluence/display/FLINK/FLIP-91%3A+Support+SQL+Gateway">FLIP-91</a> for design) 
in 1.16. SQL Gateway is an extension and enhancement to SQL Client, 
supporting multi-tenancy and pluggable API protocols (Endpoints), solving the problem that SQL Client 
can only serve a single user and cannot be integrated with external services or components. 
Currently SQL Gateway has support for REST API and HiveServer2 Protocol and users can link to 
SQL Gateway via cURL, Postman, HTTP clients in various programming languages to submit stream jobs,
batch jobs and even OLAP jobs. For HiveServer2 Endpoint, please refer to the Hive Compatibility 
for more details.</p>

<h2 id="hive-compatibility">Hive Compatibility</h2>

<p>To reduce the cost of migrating Hive to Flink, we introduce HiveServer2 Endpoint and 
Hive Syntax Improvements in this version:</p>

<p><a href="https://nightlies.apache.org/flink/flink-docs-release-1.16/docs/dev/table/hive-compatibility/hiveserver2/">The HiveServer2 Endpoint</a>
allows users to interact with SQL Gateway with Hive JDBC/Beeline and migrate with Flink into
the Hive ecosystem (DBeaver, Apache Superset, Apache DolphinScheduler, and Apache Zeppelin).
When users connect to the HiveServer2 endpoint, the SQL Gateway registers the Hive Catalog, 
switches to Hive Dialect, and uses batch execution mode to execute jobs. With these steps, 
users can have the same experience as HiveServer2.</p>

<p><a href="https://nightlies.apache.org/flink/flink-docs-release-1.16/docs/dev/table/hive-compatibility/hive-dialect/overview/">Hive syntax</a> 
is already the factual standard for big data processing. Flink has improved compatibility 
with Hive syntax and added support for several Hive syntaxes commonly used in production. 
Hive syntax compatibility can help users migrate existing Hive SQL tasks to Flink, 
and it is convenient for users who are familiar with Hive syntax to use Hive syntax to 
write SQL to query tables registered in Flink. The compatibility is measured using 
the Hive qtest suite which contains more than 12K SQL cases. Until now, for Hive 2.3, 
the compatibility has reached 94.1% for whole hive queries, and has reached 97.3% 
if ACID queries are excluded.</p>

<h2 id="join-hints-for-flink-sql">Join Hints for Flink SQL</h2>

<p>The join hint is a common solution in the industry to improve the shortcomings of the optimizer
by manually modifying the execution plans. Join is the most widely used operator in batch jobs,
and Flink supports a variety of join strategies. Missing statistics or a poor cost model of 
the optimizer can lead to the wrong choice of a join strategy, which will cause slow execution 
or even job failure. By specifying a <a href="https://nightlies.apache.org/flink/flink-docs-release-1.16/docs/dev/table/sql/queries/hints/#join-hints">Join Hint</a>, 
the optimizer will choose the join strategy specified by the user whenever possible. 
It could avoid various shortcomings of the optimizer and ensure the production availability of 
the batch job.</p>

<h2 id="adaptive-hash-join">Adaptive Hash Join</h2>

<p>For batch jobs, the hash join operators may fail if the input data is severely skewed, 
it’s a very bad experience for users. To solve this, we introduce adaptive Hash-Join
which can automatically fall back to Sort-Merge-Join once the Hash-Join fails in runtime.
This mechanism ensures that the Hash-Join is always successful and improves the stability
by gracefully degrading from a Hash-Join to a more robust Sort-Merge-Join.</p>

<h2 id="speculative-execution-for-batch-job">Speculative Execution for Batch Job</h2>

<p>Speculative execution is introduced in Flink 1.16 to mitigate batch job slowness 
which is caused by problematic nodes. A problematic node may have hardware problems, 
accident I/O busy, or high CPU load. These problems may make the hosted tasks run 
much slower than tasks on other nodes, and affect the overall execution time of a batch job.</p>

<p>When speculative execution is enabled, Flink will keep detecting slow tasks. 
Once slow tasks are detected, the nodes that the slow tasks locate in will be identified 
as problematic nodes and get blocked via the blocklist mechanism (<a href="https://cwiki.apache.org/confluence/display/FLINK/FLIP-224%3A+Blocklist+Mechanism">FLIP-224</a>). 
The scheduler will create new attempts for the slow tasks and deploy them to nodes 
that are not blocked, while the existing attempts will keep running. 
The new attempts process the same input data and produce the same data as the original attempt. 
Once any attempt finishes first, it will be admitted as the only finished attempt of the task, 
and the remaining attempts of the task will be canceled.</p>

<p>Most existing sources can work with speculative execution (<a href="https://cwiki.apache.org/confluence/display/FLINK/FLIP-245%3A+Source+Supports+Speculative+Execution+For+Batch+Job">FLIP-245</a>). 
Only if a source uses <code>SourceEvent</code>, it must implement <code>SupportsHandleExecutionAttemptSourceEvent</code> interface to support 
speculative execution. Sinks do not support speculative execution yet so that 
speculative execution will not happen on sinks at the moment.</p>

<p>The Web UI &amp; REST API are also improved (<a href="https://cwiki.apache.org/confluence/display/FLINK/FLIP-249%3A+Flink+Web+UI+Enhancement+for+Speculative+Execution">FLIP-249</a>)
to display multiple concurrent attempts of tasks and blocked task managers.</p>

<h2 id="hybrid-shuffle-mode">Hybrid Shuffle Mode</h2>

<p>We have introduced a new <a href="https://nightlies.apache.org/flink/flink-docs-release-1.16/docs/ops/batch/batch_shuffle">Hybrid Shuffle</a> 
Mode for batch executions. It combines the advantages of blocking shuffle and 
pipelined shuffle (in streaming mode).
 - Like blocking shuffle, it does not require upstream and downstream tasks to run simultaneously, 
   which allows executing a job with little resources.
 - Like pipelined shuffle, it does not require downstream tasks to be executed 
   after upstream tasks finish, which reduces the overall execution time of the job when 
   given sufficient resources.
 - It adapts to custom preferences between persisting less data and restarting less tasks on failures, 
   by providing different spilling strategies.</p>

<p>Note: This feature is experimental and by default not activated.</p>

<h2 id="further-improvements-of-blocking-shuffle">Further improvements of blocking shuffle</h2>

<p>We further improved the blocking shuffle usability and performance in this version, 
including adaptive network buffer allocation, sequential IO optimization and result partition reuse 
which allows multiple consumer vertices reusing the same physical result partition to reduce disk IO 
and storage space. These optimizations can achieve an overall 7% performance gain for 
the TPC-DS test with a scale of 10 TB. In addition, two more compression algorithms (LZO and ZSTD) 
with higher compression ratio were introduced which can further reduce the storage space with 
some CPU cost compared to the default LZ4 compression algorithm.</p>

<h2 id="dynamic-partition-pruning">Dynamic Partition Pruning</h2>

<p>For batch jobs, partitioned tables are more widely used than non-partitioned tables in 
production environments. Currently Flink has support for static partition pruning, 
where the optimizer pushes down the partition field related filter conditions in the WHERE clause 
into the Source Connector during the optimization phase, thus reducing unnecessary partition scan IO. 
The <a href="https://en.wikipedia.org/wiki/Star_schema">star-schema</a> is the simplest of 
the most commonly used data mart patterns. We have found that many user jobs cannot use 
static partition pruning because partition pruning information can only be determined in execution, 
which requires <a href="https://cwiki.apache.org/confluence/display/FLINK/FLIP-248%3A+Introduce+dynamic+partition+pruning">dynamic partition pruning techniques</a>,
where partition pruning information is collected at runtime based on data from other related tables, 
thus reducing unnecessary partition scan IO for partitioned tables. The use of dynamic partition pruning 
has been validated with the 10 TB dataset TPC-DS to improve performance by up to 30%.</p>

<h1 id="stream-processing">Stream Processing</h1>

<p>In 1.16, we have made improvements in Checkpoints, SQL, Connector and other fields, 
so that stream computing can continue to lead.</p>

<h2 id="generalized-incremental-checkpoint">Generalized incremental checkpoint</h2>

<p>Changelog state backend aims at making checkpoint intervals shorter and more predictable, 
this release is prod-ready and is dedicated to adapting changelog state backend to 
the existing state backends and improving the usability of changelog state backend:
 - Support state migration
 - Support local recovery
 - Introduce file cache to optimize restoring
 - Support switch based on checkpoint
 - Improve the monitoring experience of changelog state backend
   - expose changelog’s metrics
   - expose changelog’s configuration to webUI</p>

<p>Table 1: The comparison between Changelog Enabled / Changelog Disabled on value state 
(see <a href="https://flink.apache.org/2022/05/30/changelog-state-backend.html">this blog</a> for more details)</p>

<table>
  <thead>
    <tr>
      <th>Percentile</th>
      <th>End to End Duration</th>
      <th>Checkpointed Data Size<sup>*<sup></sup></sup></th>
      <th>Full Checkpoint Data Size<sup>*<sup></sup></sup></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>50%</td>
      <td>311ms / 5s</td>
      <td>14.8MB / 3.05GB</td>
      <td>24.2GB / 18.5GB</td>
    </tr>
    <tr>
      <td>90%</td>
      <td>664ms / 6s</td>
      <td>23.5MB / 4.52GB</td>
      <td>25.2GB / 19.3GB</td>
    </tr>
    <tr>
      <td>99%</td>
      <td>1s / 7s</td>
      <td>36.6MB / 5.19GB</td>
      <td>25.6GB / 19.6GB</td>
    </tr>
    <tr>
      <td>99.9%</td>
      <td>1s / 10s</td>
      <td>52.8MB / 6.49GB</td>
      <td>25.7GB / 19.8GB</td>
    </tr>
  </tbody>
</table>

<h2 id="rocksdb-rescaling-improvement--rescaling-benchmark">RocksDB rescaling improvement &amp; rescaling benchmark</h2>

<p>Rescaling is a frequent operation for cloud services built on Apache Flink, this release leverages 
<a href="https://rocksdb.org/blog/2018/11/21/delete-range.html">deleteRange</a> to optimize the rescaling of 
Incremental RocksDB state backend. deleteRange is used to avoid massive scan-and-delete operations, 
for upscaling with a large number of states that need to be deleted, 
the speed of restoring can be almost <a href="https://github.com/apache/flink/pull/19033#issuecomment-1072267658">increased by 2~10 times</a>.</p>

<center>
<img src="/img/rocksdb_rescaling_benchmark.png" style="width:90%;margin:15px" />
</center>

<h2 id="improve-monitoring-experience-and-usability-of-state-backend">Improve monitoring experience and usability of state backend</h2>

<p>This release also improves the monitoring experience and usability of state backend.
Previously, RocksDB’s log was located in its own DB folder, which made debugging RocksDB not so easy. 
This release lets RocksDB’s log stay in Flink’s log directory by default. RocksDB statistics-based 
metrics are introduced to help debug the performance at the database level, e.g. total block cache hit/miss
count within the DB.</p>

<h2 id="support-overdraft-buffer">Support overdraft buffer</h2>

<p>A new concept of <a href="https://nightlies.apache.org/flink/flink-docs-release-1.16/docs/deployment/memory/network_mem_tuning/#overdraft-buffers">overdraft network buffer</a> 
is introduced to mitigate the effects of uninterruptible blocking a subtask thread during back pressure, 
which can be turned on through the <a href="https://nightlies.apache.org/flink/flink-docs-release-1.16/docs/deployment/config/#taskmanager-network-memory-max-overdraft-buffers-per-gate">taskmanager.network.memory.max-overdraft-buffers-per-gate</a> 
configuration parameter.<br />
Starting from 1.16.0, Flink subtask can request by default up to 5 extra (overdraft) buffers over 
the regular configured amount.  This change can slightly increase memory consumption of 
the Flink Job but vastly reduce the checkpoint duration of the unaligned checkpoint.
If the subtask is back pressured by downstream subtasks and the subtask requires more than 
a single network buffer to finish what it’s currently doing, overdraft buffer comes into play.
Read more about this in <a href="https://nightlies.apache.org/flink/flink-docs-release-1.16/docs/deployment/memory/network_mem_tuning/#overdraft-buffers">the documentation</a>.</p>

<h2 id="timeout-aligned-to-unaligned-checkpoint-barrier-in-the-output-buffers-of-an-upstream-subtask">Timeout aligned to unaligned checkpoint barrier in the output buffers of an upstream subtask</h2>

<p>This release updates the timing of switching from Aligned Checkpoint (AC) to Unaligned Checkpoint (UC).
With UC enabled, if <a href="https://nightlies.apache.org/flink/flink-docs-release-1.16/docs/ops/state/checkpointing_under_backpressure/#aligned-checkpoint-timeout">execution.checkpointing.aligned-checkpoint-timeout</a> 
is configured, each checkpoint will still begin as an AC, but when the global checkpoint duration 
exceeds the aligned-checkpoint-timeout, if the AC has not been completed, 
then the checkpoint will be switched to unaligned.</p>

<p>Previously, the switch of one subtask needs to wait for all barriers from upstream. 
If the back pressure is severe, the downstream subtask may not receive all barriers 
within <a href="https://nightlies.apache.org/flink/flink-docs-release-1.16/docs/deployment/config/#execution-checkpointing-timeout">checkpointing-timeout</a>, 
causing the checkpoint to fail.</p>

<p>In this release, if the barrier cannot be sent from the output buffer to the downstream task 
within the <code>execution.checkpointing.aligned-checkpoint-timeout</code>, Flink lets upstream subtasks 
switch to UC first to send barriers to downstream, thereby decreasing 
the probability of checkpoint timeout during back pressure.
More details can be found in <a href="https://nightlies.apache.org/flink/flink-docs-release-1.16/docs/ops/state/checkpointing_under_backpressure/#aligned-checkpoint-timeout">this documentation</a>.</p>

<h2 id="non-determinism-in-stream-processing">Non-Determinism In Stream Processing</h2>

<p>Users often complain about the high cost of understanding stream processing.
One of the pain points is the non-determinisim in stream processing (usually not intuitive)
which may cause wrong results or errors. These pain points have been around since the
early days of Flink SQL.</p>

<p>For complex streaming jobs, now it’s possible to detect and resolve potential correctness issues 
before running. If the problems can’t be resolved completely, a detailed message could prompt users to 
adjust the SQL so as to avoid introducing non-deterministic problems. More details can be found 
in <a href="https://nightlies.apache.org/flink/flink-docs-release-1.16/docs/dev/table/concepts/determinism">the documentation</a>.</p>

<h2 id="enhanced-lookup-join">Enhanced Lookup Join</h2>

<p>Lookup join is widely used in stream processing, and we have introduced several improvements:
- Adds a unified abstraction for lookup source cache and 
  <a href="https://cwiki.apache.org/confluence/display/FLINK/FLIP-221%3A+Abstraction+for+lookup+source+cache+and+metric">related metrics</a> 
  to speed up lookup queries
- Introduces the configurable asynchronous mode (ALLOW_UNORDERED) via 
  <a href="https://nightlies.apache.org/flink/flink-docs-release-1.16/docs/dev/table/config/#table-exec-async-lookup-output-mode">job configuration</a> 
  or <a href="https://nightlies.apache.org/flink/flink-docs-release-1.16/docs/dev/table/sql/queries/hints/#lookup">lookup hint</a> 
  to significantly improve query throughput without compromising correctness.
- <a href="https://nightlies.apache.org/flink/flink-docs-master/docs/dev/table/sql/queries/hints/#3-enable-delayed-retry-strategy-for-lookup">Retryable lookup mechanism</a> 
  gives users more tools to solve the delayed updates issue in external systems.</p>

<h2 id="retry-support-for-async-io">Retry Support For Async I/O</h2>

<p>Introduces a built-in retry mechanism for <a href="https://nightlies.apache.org/flink/flink-docs-release-1.16/docs/dev/datastream/operators/asyncio/#retry-support">asynchronous I/O</a> 
that is transparent to the user’s existing code, allowing flexibility to meet 
the user’s retry and exception handling needs.</p>

<h1 id="pyflink">PyFlink</h1>

<p>In Flink 1.15, we have introduced a new execution mode ‘thread’ mode in 
which the user-defined Python functions will be executed in the JVM via JNI instead of 
in a separate Python process. However, it’s only supported for Python scalar functions in 
the Table API &amp; SQL in Flink 1.15. In this release, we have provided more comprehensive support for it. 
It has also been supported in the Python DataStream API and also Python table functions 
in the Table API &amp; SQL.</p>

<p>We are also continuing to fill in the last few missing features in Python API. In this release, 
we have provided more comprehensive support for Python DataStream API and supported features 
such as side output, broadcast state, etc and have also finalized the windowing support. 
We have also added support for more connectors and formats in the Python DataStream API, 
e.g. added support for connectors elasticsearch, kinesis, pulsar, hybrid source, etc and 
formats orc, parquet, etc. With all these features added, the Python API should have aligned 
most notable features in the Java &amp; Scala API and users should be able to develop most 
kinds of Flink jobs using Python language smoothly.</p>

<h1 id="others">Others</h1>

<h2 id="new-sql-syntax">New SQL Syntax</h2>

<p>In 1.16, we extend more DDL syntaxes which could help users to better use SQL:
- <a href="https://nightlies.apache.org/flink/flink-docs-release-1.16/docs/dev/table/sql/create/#create-function">USING JAR</a> 
  supports dynamic loading of UDF jar to help platform developers to easily manage UDF.
- <a href="https://nightlies.apache.org/flink/flink-docs-release-1.16/docs/dev/table/sql/create/#as-select_statement">CREATE TABLE AS SELECT</a> (CTAS) 
  supports users to create new tables based on existing tables and queries.
- <a href="https://nightlies.apache.org/flink/flink-docs-release-1.16/zh/docs/dev/table/sql/analyze">ANALYZE TABLE</a> 
  supports users to manually generate table statistics so that the optimizer could 
  generate better execution plans.</p>

<h2 id="cache-in-datastream-for-interactive-programming">Cache in DataStream for Interactive Programming</h2>

<p>Supports caching the result of a transformation via <a href="https://nightlies.apache.org/flink/flink-docs-release-1.16/docs/dev/datastream/operators/overview/#cache">DataStream#cache</a>. 
The cached intermediate result is generated lazily at the first time the intermediate result is 
computed so that the result can be reused by later jobs. If the cache is lost, 
it will be recomputed using the original transformations. Currently only batch mode is supported. 
This feature is very useful for ML and interactive programming in Python.</p>

<h2 id="history-server--completed-jobs-information-enhancement">History Server &amp; Completed Jobs Information Enhancement</h2>

<p>We have enhanced the experiences of viewing completed jobs’ information in this release.
- JobManager / HistoryServer WebUI now provides detailed execution time metrics, 
  including duration tasks spent in each execution state and the accumulated 
  busy / idle / back-pressured time during running.
- JobManager / HistoryServer WebUI now provides aggregation of major SubTask metrics, 
  grouped by Task or TaskManager.
- JobManager / HistoryServer WebUI now provides more environmental information, 
  including environment variables, JVM options and classpath.
- HistoryServer now supports browsing logs[6] from external log archiving services.</p>

<h2 id="protobuf-format">Protobuf format</h2>

<p>Flink now supports the Protocol Buffers (Protobuf) format. This allows you to use this format directly 
in your Table API or SQL applications.</p>

<h2 id="introduce-configurable-ratelimitingstrategy-for-async-sink">Introduce configurable RateLimitingStrategy for Async Sink</h2>

<p>The Async Sink was implemented in 1.15 to allow users to easily implement 
their own custom asynchronous sinks. We have now extended it to support 
a configurable RateLimitingStrategy. This means sink implementers can now customize 
how their Async Sink behaves when requests fail, depending on the specific sink. 
If no RateLimitingStrategy is specified, it will default to the current default of AIMDRateLimitingStrategy.</p>

<h1 id="upgrade-notes">Upgrade Notes</h1>

<p>We aim to make upgrades as smooth as possible, but some of the changes require users to 
adjust some parts of the program when upgrading to Apache Flink 1.16. Please take a look at 
the release notes for a list of adjustments to make and issues to check during upgrades.</p>

<h1 id="list-of-contributors">List of Contributors</h1>

<p>The Apache Flink community would like to thank each one of the contributors that have made this release possible:</p>

<p>1996fanrui, Ada Wang, Ada Wong, Ahmed Hamdy, Aitozi, Alexander Fedulov, Alexander Preuß, Alexander Trushev, 
Andriy Redko, Anton Kalashnikov, Arvid Heise, Ben Augarten, Benchao Li, BiGsuw, Biao Geng, Bobby Richard, 
Brayno, CPS794, Cheng Pan, Chengkai Yang, Chesnay Schepler, Danny Cranmer, David N Perkins, Dawid Wysakowicz, 
Dian Fu, DingGeGe, EchoLee5, Etienne Chauchot, Fabian Paul, Ferenc Csaky, Francesco Guardiani, Gabor Somogyi, 
Gen Luo, Gyula Fora, Haizhou Zhao, Hangxiang Yu, Hao Wang, Hong Liang Teoh, Hong Teoh, Hongbo Miao, HuangXingBo, 
Ingo Bürk, Jacky Lau, Jane Chan, Jark Wu, Jay Li, Jia Liu, Jie Wang, Jin, Jing Ge, Jing Zhang, Jingsong Lee, 
Jinhu Wu, Joe Moser, Joey Pereira, Jun He, JunRuiLee, Juntao Hu, JustDoDT, Kai Chen, Krzysztof Chmielewski, 
Krzysztof Dziolak, Kyle Dong, LeoZhang, Levani Kokhreidze, Lihe Ma, Lijie Wang, Liu Jiangang, Luning Wang, 
Marios Trivyzas, Martijn Visser, MartijnVisser, Mason Chen, Matthias Pohl, Metehan Yıldırım, Michael, Mingde Peng, 
Mingliang Liu, Mulavar, Márton Balassi, Nie yingping, Niklas Semmler, Paul Lam, Paul Lin, Paul Zhang, PengYuan, 
Piotr Nowojski, Qingsheng Ren, Qishang Zhong, Ran Tao, Robert Metzger, Roc Marshal, Roman Boyko, Roman Khachatryan, 
Ron, Ron Cohen, Ruanshubin, Rudi Kershaw, Rufus Refactor, Ryan Skraba, Sebastian Mattheis, Sergey, Sergey Nuyanzin, 
Shengkai, Shubham Bansal, SmirAlex, Smirnov Alexander, SteNicholas, Steven van Rossum, Suhan Mao, Tan Yuxin, 
Tartarus0zm, TennyZhuang, Terry Wang, Thesharing, Thomas Weise, Timo Walther, Tom, Tony Wei, Weijie Guo, Wencong Liu, 
WencongLiu, Xintong Song, Xuyang, Yangze Guo, Yi Tang, Yu Chen, Yuan Huang, Yubin Li, Yufan Sheng, Yufei Zhang, 
Yun Gao, Yun Tang, Yuxin Tan, Zakelly, Zhanghao Chen, Zhu Zhu, Zichen Liu, Zili Sun, acquachen, bgeng777, billyrrr, 
bzhao, caoyu, chenlei677, chenzihao, chenzihao5, coderap, cphe, davidliu, dependabot[bot], dkkb, dusukang, empcl, 
eyys, fanrui, fengjiankun, fengli, fredia, gabor.g.somogyi, godfreyhe, gongzhongqiang, harker2015, hongli, 
huangxingbo, huweihua, jayce, jaydonzhou, jiabao.sun, kevin.cyj, kurt, lidefu, lijiewang.wlj, liliwei, lincoln lee, 
lincoln.lil, littleeleventhwolf, liufangqi, liujia10, liujiangang, liujingmao, liuyongvs, liuzhuang2017, longwang, 
lovewin99, luoyuxia, mans2singh, maosuhan, mayue.fight, mayuehappy, nieyingping, pengmide, pengmingde, polaris6, 
pvary, qinjunjerry, realdengziqi, root, shammon, shihong90, shuiqiangchen, slinkydeveloper, snailHumming, snuyanzin, 
suxinglee, sxnan, tison, trushev, tsreaper, unknown, wangfeifan, wangyang0918, wangzhiwu, wenbingshen, xiangqiao123, 
xuyang, yangjf2019, yangjunhan, yangsanity, yangxin, ylchou, yuchengxin, yunfengzhou-hub, yuxia Luo, yuzelin, 
zhangchaoming, zhangjingcun, zhangmang, zhangzhengqi3, zhaoweinan, zhengyunhong.zyh, zhenyu xing, zhouli, 
zhuanshenbsj1, zhuzhu.zz, zoucao, zp, 周磊, 饶紫轩,, 鲍健昕 愚鲤, 帝国阿三</p>

      </article>
    </div>

    <div class="row">
      <div id="disqus_thread"></div>
      <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'stratosphere-eu'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
             (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
      </script>
    </div>
  </div>
</div>
      </div>
    </div>

    <hr />

    <div class="row">
      <div class="footer text-center col-sm-12">
        <p>Copyright © 2014-2022 <a href="http://apache.org">The Apache Software Foundation</a>. All Rights Reserved.</p>
        <p>Apache Flink, Flink®, Apache®, the squirrel logo, and the Apache feather logo are either registered trademarks or trademarks of The Apache Software Foundation.</p>
        <p><a href="https://privacy.apache.org/policies/privacy-policy-public.html">Privacy Policy</a> &middot; <a href="/blog/feed.xml">RSS feed</a></p>
      </div>
    </div>
    </div><!-- /.container -->

    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="/js/jquery.matchHeight-min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/codetabs.js"></script>
    <script src="/js/stickysidebar.js"></script>
  </body>
</html>
