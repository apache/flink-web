<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Apache Flink: Apache Flink Code Style and Quality Guide — Pull Requests & Changes</title>
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/flink.css">
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Blog RSS feed -->
    <link href="/blog/feed.xml" rel="alternate" type="application/rss+xml" title="Apache Flink Blog: RSS feed" />

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <!-- We need to load Jquery in the header for custom google analytics event tracking-->
    <script src="/js/jquery.min.js"></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>  
    

    <!-- Main content. -->
    <div class="container">
    <div class="row">

      
     <div id="sidebar" class="col-sm-3">
        

<!-- Top navbar. -->
    <nav class="navbar navbar-default">
        <!-- The logo. -->
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <div class="navbar-logo">
            <a href="/zh/">
              <img alt="Apache Flink" src="/img/flink-header-logo.svg" width="147px" height="73px">
            </a>
          </div>
        </div><!-- /.navbar-header -->

        <!-- The navigation links. -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
          <ul class="nav navbar-nav navbar-main">

            <!-- First menu section explains visitors what Flink is -->

            <!-- What is Stream Processing? -->
            <!--
            <li><a href="/zh/streamprocessing1.html">What is Stream Processing?</a></li>
            -->

            <!-- What is Flink? -->
            <li><a href="/zh/flink-architecture.html">Apache Flink 是什么?</a></li>

            

            <!-- What is Stateful Functions? -->

            <li><a href="/zh/stateful-functions.html">What is Stateful Functions?</a></li>

            <!-- Use cases -->
            <li><a href="/zh/usecases.html">应用场景</a></li>

            <!-- Powered by -->
            <li><a href="/zh/poweredby.html">Flink 用户</a></li>


            &nbsp;
            <!-- Second menu section aims to support Flink users -->

            <!-- Downloads -->
            <li><a href="/zh/downloads.html">下载</a></li>

            <!-- Getting Started -->
            <li class="dropdown">
              <a class="dropdown-toggle" data-toggle="dropdown" href="#">教程<span class="caret"></span></a>
              <ul class="dropdown-menu">
                <li><a href="https://ci.apache.org/projects/flink/flink-docs-release-1.12/zh/try-flink/index.html" target="_blank">With Flink <small><span class="glyphicon glyphicon-new-window"></span></small></a></li>
                <li><a href="https://ci.apache.org/projects/flink/flink-statefun-docs-release-2.2/getting-started/project-setup.html" target="_blank">With Flink Stateful Functions <small><span class="glyphicon glyphicon-new-window"></span></small></a></li>
                <li><a href="/zh/training.html">Training Course</a></li>
              </ul>
            </li>

            <!-- Documentation -->
            <li class="dropdown">
              <a class="dropdown-toggle" data-toggle="dropdown" href="#">文档<span class="caret"></span></a>
              <ul class="dropdown-menu">
                <li><a href="https://ci.apache.org/projects/flink/flink-docs-release-1.12" target="_blank">Flink 1.12 (Latest stable release) <small><span class="glyphicon glyphicon-new-window"></span></small></a></li>
                <li><a href="https://ci.apache.org/projects/flink/flink-docs-master" target="_blank">Flink Master (Latest Snapshot) <small><span class="glyphicon glyphicon-new-window"></span></small></a></li>
                <li><a href="https://ci.apache.org/projects/flink/flink-statefun-docs-release-2.2" target="_blank">Flink Stateful Functions 2.2 (Latest stable release) <small><span class="glyphicon glyphicon-new-window"></span></small></a></li>
                <li><a href="https://ci.apache.org/projects/flink/flink-statefun-docs-master" target="_blank">Flink Stateful Functions Master (Latest Snapshot) <small><span class="glyphicon glyphicon-new-window"></span></small></a></li>
              </ul>
            </li>

            <!-- getting help -->
            <li><a href="/zh/gettinghelp.html">获取帮助</a></li>

            <!-- Blog -->
            <li><a href="/blog/"><b>Flink 博客</b></a></li>


            <!-- Flink-packages -->
            <li>
              <a href="https://flink-packages.org" target="_blank">flink-packages.org <small><span class="glyphicon glyphicon-new-window"></span></small></a>
            </li>
            &nbsp;

            <!-- Third menu section aim to support community and contributors -->

            <!-- Community -->
            <li><a href="/zh/community.html">社区 &amp; 项目信息</a></li>

            <!-- Roadmap -->
            <li><a href="/zh/roadmap.html">开发计划</a></li>

            <!-- Contribute -->
            <li><a href="/zh/contributing/how-to-contribute.html">如何参与贡献</a></li>
            
            <ul class="nav navbar-nav navbar-subnav">
              <li >
                  <a href="/zh/contributing/contribute-code.html">贡献代码</a>
              </li>
              <li >
                  <a href="/zh/contributing/reviewing-prs.html">审核 Pull Request</a>
              </li>
              <li >
                  <a href="/zh/contributing/code-style-and-quality-preamble.html">代码样式与质量指南</a>
              </li>
              <li >
                  <a href="/zh/contributing/contribute-documentation.html">贡献文档</a>
              </li>
              <li >
                  <a href="/zh/contributing/docs-style.html">Documentation Style Guide</a>
              </li>
              <li >
                  <a href="/zh/contributing/improve-website.html">贡献网站</a>
              </li>
            </ul>
            

            <!-- GitHub -->
            <li>
              <a href="https://github.com/apache/flink" target="_blank">Flink on GitHub <small><span class="glyphicon glyphicon-new-window"></span></small></a>
            </li>

            &nbsp;

            <!-- Language Switcher -->
            <li>
              
                <a href="/contributing/code-style-and-quality-pull-requests.html">English</a>
              
            </li>

          </ul>

          <ul class="nav navbar-nav navbar-bottom">
          <hr />

            <!-- Twitter -->
            <li><a href="https://twitter.com/apacheflink" target="_blank">@ApacheFlink <small><span class="glyphicon glyphicon-new-window"></span></small></a></li>

            <!-- Visualizer -->
            <li class=" hidden-md hidden-sm"><a href="/visualizer/" target="_blank">Plan Visualizer <small><span class="glyphicon glyphicon-new-window"></span></small></a></li>

          <hr />

            <li><a href="https://apache.org" target="_blank">Apache Software Foundation <small><span class="glyphicon glyphicon-new-window"></span></small></a></li>

            <li>
              <style>
                .smalllinks:link {
                  display: inline-block !important; background: none; padding-top: 0px; padding-bottom: 0px; padding-right: 0px; min-width: 75px;
                }
              </style>

              <a class="smalllinks" href="https://www.apache.org/licenses/" target="_blank">License</a> <small><span class="glyphicon glyphicon-new-window"></span></small>

              <a class="smalllinks" href="https://www.apache.org/security/" target="_blank">Security</a> <small><span class="glyphicon glyphicon-new-window"></span></small>

              <a class="smalllinks" href="https://www.apache.org/foundation/sponsorship.html" target="_blank">Donate</a> <small><span class="glyphicon glyphicon-new-window"></span></small>

              <a class="smalllinks" href="https://www.apache.org/foundation/thanks.html" target="_blank">Thanks</a> <small><span class="glyphicon glyphicon-new-window"></span></small>
            </li>

          </ul>
        </div><!-- /.navbar-collapse -->
    </nav>

      </div>
      <div class="col-sm-9">
      <div class="row-fluid">
  <div class="col-sm-12">
    <h1>Apache Flink Code Style and Quality Guide — Pull Requests & Changes</h1>

	
<ul class="list-group" style="padding-top: 30px; font-weight: bold;">
	<li class="list-group-item">
		<a href="/zh/contributing/code-style-and-quality-preamble.html">
			序言
		</a>
	</li>
	<li class="list-group-item">
		<a href="/zh/contributing/code-style-and-quality-pull-requests.html">
			Pull Requests &amp; Changes
		</a>
	</li>
	<li class="list-group-item">
		<a href="/zh/contributing/code-style-and-quality-common.html">
			常用编码指南
		</a> 
	</li>
	<li class="list-group-item">
		<a href="/zh/contributing/code-style-and-quality-java.html">
			Java 语言指南
		</a> 
	</li>
	<li class="list-group-item">
		<a href="/zh/contributing/code-style-and-quality-scala.html">
			Scala 语言指南
		</a> 
	</li>
	<li class="list-group-item">
		<a href="/zh/contributing/code-style-and-quality-components.html">
			组件指南
		</a> 
	</li>
	<li class="list-group-item">
		<a href="/zh/contributing/code-style-and-quality-formatting.html">
			格式指南
		</a> 
	</li>
</ul>

<hr />

<div class="page-toc">
<ul id="markdown-toc">
  <li><a href="#jira-issue-and-naming" id="markdown-toc-jira-issue-and-naming">1. JIRA issue and Naming</a></li>
  <li><a href="#description" id="markdown-toc-description">2. Description</a></li>
  <li><a href="#separate-refactoring-cleanup-and-independent-changes" id="markdown-toc-separate-refactoring-cleanup-and-independent-changes">3. Separate Refactoring, Cleanup and Independent Changes</a></li>
  <li><a href="#commit-naming-conventions" id="markdown-toc-commit-naming-conventions">4. Commit Naming Conventions</a></li>
  <li><a href="#changes-to-the-observable-behavior-of-the-system" id="markdown-toc-changes-to-the-observable-behavior-of-the-system">5. Changes to the observable behavior of the system</a></li>
</ul>

</div>

<p><strong>Rationale:</strong> We ask contributors to put in a little bit of extra effort to bring pull requests into a state that they can be more easily and more thoroughly reviewed. This helps the community in many ways:</p>

<ul>
  <li>Reviews are much faster and thus contributions get merged sooner.</li>
  <li>We can ensure higher code quality by overlooking fewer issues in the contributions.</li>
  <li>Committers can review more contributions in the same time, which helps to keep up with the high rate of contributions that Flink is experiencing</li>
</ul>

<p>Please understand that contributions that do not follow this guide will take longer to review and thus will typically be picked up with lower priority by the community. That is not ill intend, it is due to the added complexity of reviewing unstructured Pull Requests.</p>

<h2 id="jira-issue-and-naming">1. JIRA issue and Naming</h2>

<p>Make sure that the pull request corresponds to a <a href="[https://issues.apache.org/jira/projects/FLINK/issues">JIRA issue</a>.</p>

<p>Exceptions are <strong>**hotfixes</strong>**, like fixing typos in JavaDocs or documentation files.</p>

<p>Name the pull request in the form <code>[FLINK-XXXX][component] Title of the pull request</code>, where <code>FLINK-XXXX</code> should be replaced by the actual issue number. The components should be the same as used in the JIRA issue.</p>

<p>Hotfixes should be named for example <code>[hotfix][docs] Fix typo in event time introduction</code> or <code>[hotfix][javadocs] Expand JavaDoc for PuncuatedWatermarkGenerator</code>.</p>

<h2 id="description">2. Description</h2>

<p>Please fill out the pull request template to describe the contribution. Please describe it such that the reviewer understands the problem and solution from the description, not only from the code.</p>

<p>A stellar example of a well-described pull request is <a href="https://github.com/apache/flink/pull/7264">https://github.com/apache/flink/pull/7264</a></p>

<p>Make sure that the description is adequate for the problem solved by PR. Small changes do not need a wall of text. In ideal cases, the problem was described in the Jira issue and the description be mostly copied from there.</p>

<p>If additional open questions / issues were discovered during the implementation and you made a choice regarding those, describe them in the pull request text so that reviewers can double check the assumptions. And example is in <a href="https://github.com/apache/flink/pull/8290">https://github.com/apache/flink/pull/8290</a> (Section “Open Architecture Questions”).</p>

<h2 id="separate-refactoring-cleanup-and-independent-changes">3. Separate Refactoring, Cleanup and Independent Changes</h2>

<p><strong>**NOTE: This is not an optimization, this is a critical requirement.</strong>**</p>

<p>Pull Requests must put cleanup, refactoring, and core changes into separate commits. That way, the reviewer can look independently at the cleanup and refactoring and ensure that those changes to not alter the behavior. Then the reviewer can look at the core changes in isolation (without the noise of other changes) and ensure that this is a clean and robust change.</p>

<p>Examples for changes that strictly need to go into a separate commit include</p>

<ul>
  <li>Cleanup, fixing style and warnings in pre-existing code</li>
  <li>Renaming packages, classes, or methods</li>
  <li>Moving code (to other packages or classes)</li>
  <li>Refactoring structure or changing design patterns</li>
  <li>Consolidating related tests or utilities</li>
  <li>Changing the assumptions in existing tests (add a commit message that describes why the changed assumptions make sense).</li>
</ul>

<p>There should be no cleanup commits that fix issues that have been introduced in previous commits of the same PR. Commits should be clean in themselves.</p>

<p>In addition, any larger contributions should split the changes into a set of independent changes that can be independently reviewed.</p>

<p>Two great examples of splitting issues into separate commits are:</p>

<ul>
  <li><a href="https://github.com/apache/flink/pull/6692">https://github.com/apache/flink/pull/6692</a> (splits cleanup and refactoring from main changes)</li>
  <li><a href="https://github.com/apache/flink/pull/7264">https://github.com/apache/flink/pull/7264</a> (splits also main changes into independently reviewable pieces)</li>
</ul>

<p>If a pull request does still contain big commits (e.g. a commit with more than 1000 changed lines), it might be worth thinking about how to split the commit into multiple subproblems, as in the example above.</p>

<h2 id="commit-naming-conventions">4. Commit Naming Conventions</h2>

<p>Commit messages should follow a similar pattern as the pull request as a whole: 
<code>[FLINK-XXXX][component] Commit description</code>.</p>

<p>In some cases, the issue might be a subtask here, and the component may be different from the Pull Request’s main component. For example, when the commit introduces an end-to-end test for a runtime change, the PR would be tagged as <code>[runtime]</code>, but the individual commit would be tagged as <code>[e2e]</code>.</p>

<p>Examples for commit messages:</p>

<ul>
  <li><code>[hotfix] Fix update_branch_version.sh to allow version suffixes</code></li>
  <li><code>[hotfix] [table] Remove unused geometry dependency</code></li>
  <li><code>[FLINK-11704][tests] Improve AbstractCheckpointStateOutputStreamTestBase</code></li>
  <li><code>[FLINK-10569][runtime] Remove Instance usage in ExecutionVertexCancelTest</code></li>
  <li><code>[FLINK-11702][table-planner-blink] Introduce a new table type system</code></li>
</ul>

<h2 id="changes-to-the-observable-behavior-of-the-system">5. Changes to the observable behavior of the system</h2>

<p>Contributors should be aware of changes in their PRs that break the observable behavior of Flink in any way because in many cases such changes can break existing setups. Red flags that should raise questions while coding or in reviews with respect to this problem are for example:</p>

<ul>
  <li>Assertions have been changed to make tests pass again with the breaking change.</li>
  <li>Configuration setting that must suddenly be set to (non-default) values to keep existing tests passing. This can happen in particular for new settings with a breaking default.</li>
  <li>Existing scripts or configurations have to be adjusted.</li>
</ul>


  </div>
</div>

      </div>
    </div>

    <hr />

    <div class="row">
      <div class="footer text-center col-sm-12">
        <p>Copyright © 2014-2019 <a href="http://apache.org">The Apache Software Foundation</a>. All Rights Reserved.</p>
        <p>Apache Flink, Flink®, Apache®, the squirrel logo, and the Apache feather logo are either registered trademarks or trademarks of The Apache Software Foundation.</p>
        <p><a href="/privacy-policy.html">Privacy Policy</a> &middot; <a href="/blog/feed.xml">RSS feed</a></p>
      </div>
    </div>
    </div><!-- /.container -->

    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.matchHeight/0.7.0/jquery.matchHeight-min.js"></script>
    <script src="/js/codetabs.js"></script>
    <script src="/js/stickysidebar.js"></script>

    <!-- Google Analytics -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-52545728-1', 'auto');
      ga('send', 'pageview');
    </script>
  </body>
</html>
